<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
         .container{
            display: grid;
            grid-template-columns: repeat(3,1fr);
            gap:10px;
            margin-top: 10px;
         }
        .cards{
            background-color: rgb(154, 133, 175);
         }
         #pagination{
            display: flex;
            justify-content: center;
            list-style-type: none;
            gap: 20px;
         }
         #pagination>li{
            background-color: aqua;
            color: aliceblue;
            padding: 10px;

         }



    </style>
</head>
<body>
    <button> <a href="form.html">register</a> </button>
    <input type="text" oninput="search()"/>
    <select onchange="filtering()" >
        <option>years</option>
        <option value="2019">2019</option>
        <option value="2020">2020</option>
        <option value="2021">2021</option>
        <option value="2022">2022</option>
    </select>

    <select class="sort" onchange="sorting()" >
        <option>sorting</option>
        <option value="h2l">hight to low</option>
        <option value="l2h">low to high</option>
        
    </select>

    <ul id="pagination"></ul>
<div class="container"></div>

    
</body>
</html>
<script>
    //pagination //sorting //filtering //search
    let data=[]  
     fetch("https://masa-14a20-default-rtdb.firebaseio.com/items.json")
    .then((res)=> res.json())
    .then((data2)=> {
        data=Object.values(data2) //converting to array 
         displaycards(data)  // show cards
        setpagiantion (data) // show pagiantion
    })  

    // displaying
    function displaycards(data){
        document.querySelector(".container").innerHTML="" //empty it
        let start =(currentpage-1)*limit // for pagination purpose
        let end = start + limit
        let paginateddata=data.slice(start , end ) //start end defined for pagianted data
        paginateddata.forEach(element => {            //using paginated data to iterate
            document.querySelector(".container").innerHTML+=
            //using ele.title coz object.values used// ele[1].title when object.values.entries used
        `
  <div class="cards">
         <p>Title :${element.title}</p>       
         <p>Author :${element.author}</p>
        <p>Release :${element.release_year}</p>
         <p>price :${element.price}</p>
        <p>genre :${element.genre}</p>
  </div>
        `
        });
    }
    ///////////////// for PAGINATION ///////////////////////////////
    let currentpage= 1
    let limit=5
    function setpagiantion (){

        let pagecount= Math.ceil(data.length/limit) //count pages
        document.querySelector("ul").innerHTML = ""; //emty 

        for(let i = 1 ; i<=pagecount ; i++){           //loop to set value of i to 1234
            let pageitem = document.createElement("li")  //create li tag
          pageitem.innerText=i                           //set value of li tag
          pageitem.addEventListener("click" ,function(){   // add event listner when clicked page should change
            currentpage=i
            displaycards(data) //display data when page is changed
          } )
          document.querySelector("ul").append(pageitem) //apending li to ul tag
        console.log(pagecount)
        }
        
    }
////////////SORTING///////////////////<select class="sort" onchange="sorting()" >
    function sorting(){
       let sortv= document.querySelector(".sort").value  //catching value of select tag
        if(sortv=="h2l"){
            data.sort((a,b)=> b.price -a.price)
        }else if(sortv=="l2h"){
            data.sort((a,b)=> a.price-b.price )
        }
        displaycards(data)
    }
/////////////      FILTER       //////////////////// <select onchange="filtering()" >
function filtering(){
    let value1 = +document.querySelector("select").value //catching value + for
    let filtered = data.filter(function(element){   //adding filter
        return +element.release_year===value1   //returning filtered value
    })
    displaycards(filtered) //display filtered data
}

/////////////      Search          /////////////////////<input type="text" oninput="search()"/>
    function search(){
       let searchtext = document.querySelector("input").value.toLowerCase() // catching input
       let searchresult = data.filter(function(element){                  //filtering
        return element.title.toLowerCase().includes(searchtext)            //returning filtered data
       })
       displaycards(searchresult) // displaying filtered data
    }


/////////crud operation//////////////






    // displaycards(data)
</script>